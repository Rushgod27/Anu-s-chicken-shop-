<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chicken Shop POS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; }

body {
  font-family: "Segoe UI", system-ui;
  background: linear-gradient(135deg, #fdf6f0, #eef2ff);
  padding: 24px;
  color: #2f2f2f;
}

.app {
  max-width: 1100px;
  margin: auto;
  display: grid;
  gap: 24px;
}

/* TOP PRICES */
.prices {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 18px;
  padding: 18px;
  border-radius: 20px;
  background: linear-gradient(135deg, #c7d2fe, #e0e7ff);
}

.price-box label { font-weight: 700; }
.price-box input {
  width: 100%;
  padding: 12px;
  border-radius: 14px;
  border: none;
  font-size: 16px;
}

/* MAIN */
.main {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 24px;
}

/* BILLING */
.billing {
  background: linear-gradient(135deg, #fff7ed, #ffedd5);
  padding: 20px;
  border-radius: 24px;
}

.billing h3 {
  text-align: center;
  font-size: 26px;
}

/* ICON GROUP */
.icon-group {
  display: flex;
  gap: 14px;
  margin: 10px 0 18px;
}

.icon-btn {
  flex: 1;
  padding: 16px 0;
  border-radius: 20px;
  border: none;
  font-size: 17px;
  font-weight: 700;
  cursor: pointer;
  background: #f1f5f9;
}

.icon-btn.active {
  background: linear-gradient(135deg, #fde68a, #fbbf24);
}

.field label { font-weight: 700; }
.field input {
  width: 100%;
  padding: 12px;
  font-size: 16px;
  border-radius: 14px;
  border: none;
}

/* TOTALS */
.totals {
  background: linear-gradient(135deg, #ecfeff, #cffafe);
  padding: 20px;
  border-radius: 24px;
}

.total-box {
  background: rgba(255,255,255,.85);
  border-radius: 18px;
  padding: 16px;
  text-align: center;
  font-weight: 700;
  margin-bottom: 12px;
}

.total-box span { font-size: 26px; }

#balance {
  font-size: 30px;
  font-weight: 900;
}

button.next {
  width: 100%;
  margin-top: 14px;
  padding: 14px;
  border-radius: 18px;
  border: none;
  background: #6366f1;
  color: white;
  font-size: 16px;
  font-weight: 700;
  cursor: pointer;
}

@media(max-width:900px){
  .main { grid-template-columns: 1fr; }
  .prices { grid-template-columns: 1fr; }
}
</style>
</head>

<body>

<div class="app">

<!-- PRICES -->
<div class="prices">
  <div class="price-box">
    <label>ğŸ” Broiler (â‚¹ / Kg)</label>
    <input id="broilerPrice" type="number">
  </div>
  <div class="price-box">
    <label>ğŸ“ Country (â‚¹ / Kg)</label>
    <input id="countryPrice" type="number">
  </div>
  <div class="price-box">
    <label>ğŸ¥š Egg (â‚¹ / Unit)</label>
    <input id="eggPrice" type="number">
  </div>
</div>

<div class="main">

<!-- BILLING -->
<div class="billing">
<h3>ğŸ§¾ Billing</h3>

<label>ğŸ” Chicken Type</label>
<div class="icon-group">
  <button class="icon-btn" id="broilerBtn">ğŸ”<br>Broiler</button>
  <button class="icon-btn" id="countryBtn">ğŸ“<br>Country</button>
</div>

<label>âš–ï¸ Sale Mode</label>
<div class="icon-group">
  <button class="icon-btn" id="kgMode">âš–ï¸<br>By KG</button>
  <button class="icon-btn" id="rsMode">ğŸ’°<br>By â‚¹</button>
</div>

<div class="field" id="kgBlock" style="display:none">
<label>Weight (KG)</label>
<input id="kgInput" type="number" step="0.01">
</div>

<div class="field" id="amountBlock" style="display:none">
<label>Amount (â‚¹)</label>
<input id="amountInput" type="number">
</div>

<div class="field">
<label>ğŸ¥š Egg Units</label>
<input id="eggQty" type="number">
</div>

<div class="field">
<label>ğŸ’µ Amount Received</label>
<input id="amountReceived" type="number">
</div>

<button class="next" id="nextCustomerBtn">ğŸ§¾ Next Customer</button>
</div>

<!-- TOTALS -->
<div class="totals">
<div class="total-box">ğŸ” Chicken â‚¹<span id="chickenTotal">0.00</span></div>
<div class="total-box">ğŸ¥š Egg â‚¹<span id="eggTotal">0.00</span></div>
<div class="total-box">ğŸ’° Total â‚¹<span id="grandTotal">0.00</span></div>
<div class="total-box">ğŸ” Balance â‚¹<span id="balance">0.00</span></div>
<div class="total-box">ğŸ“Š Today â‚¹<span id="dailyTotal">0.00</span></div>
</div>

</div>
</div>

<script>
/* âœ… SAFE LOCAL DATE (NO UTC BUG) */
function getLocalDateKey() {
  const d = new Date();
  return d.getFullYear() + "-" +
         String(d.getMonth()+1).padStart(2,"0") + "-" +
         String(d.getDate()).padStart(2,"0");
}

/* ğŸ”„ DAILY RESET (SALES ONLY) */
const todayKey = getLocalDateKey();
const savedDate = localStorage.getItem("salesDate");

if (savedDate !== todayKey) {
  localStorage.setItem("salesDate", todayKey);
  localStorage.setItem("dailySales", "0");
}

let dailySales = Number(localStorage.getItem("dailySales")) || 0;
dailyTotal.innerText = dailySales.toFixed(2);

/* STATE */
let selectedChicken = null;
let saleMode = null;

/* ICON LOGIC */
broilerBtn.onclick = () => selectChicken("broiler");
countryBtn.onclick = () => selectChicken("country");

function selectChicken(type) {
  selectedChicken = type;
  broilerBtn.classList.toggle("active", type === "broiler");
  countryBtn.classList.toggle("active", type === "country");
  calculate();
}

kgMode.onclick = () => setMode("kg");
rsMode.onclick = () => setMode("rs");

function setMode(mode) {
  saleMode = mode;
  kgMode.classList.toggle("active", mode === "kg");
  rsMode.classList.toggle("active", mode === "rs");
  kgBlock.style.display = mode === "kg" ? "block" : "none";
  amountBlock.style.display = mode === "rs" ? "block" : "none";
  kgInput.value = amountInput.value = "";
  calculate();
}

/* SAVE + LOAD PRICES */
function savePrices() {
  localStorage.setItem("broiler", broilerPrice.value);
  localStorage.setItem("country", countryPrice.value);
  localStorage.setItem("egg", eggPrice.value);
}
function loadPrices() {
  broilerPrice.value = localStorage.getItem("broiler") || "";
  countryPrice.value = localStorage.getItem("country") || "";
  eggPrice.value = localStorage.getItem("egg") || "";
}
loadPrices();
broilerPrice.oninput = countryPrice.oninput = eggPrice.oninput = savePrices;

/* CALC */
document.querySelectorAll("input").forEach(el => el.oninput = calculate);

function calculate() {
  const egg = (Number(eggQty.value)||0) * (Number(eggPrice.value)||0);

  if (!selectedChicken || !saleMode) {
    chickenTotal.innerText = "0.00";
    eggTotal.innerText = egg.toFixed(2);
    grandTotal.innerText = egg.toFixed(2);
    balance.innerText = ((Number(amountReceived.value)||0) - egg).toFixed(2);
    return;
  }

  const rate = selectedChicken === "broiler"
    ? Number(broilerPrice.value||0)
    : Number(countryPrice.value||0);

  const chicken =
    saleMode === "kg"
      ? (Number(kgInput.value)||0) * rate
      : Number(amountInput.value)||0;

  const total = chicken + egg;
  const bal = (Number(amountReceived.value)||0) - total;

  chickenTotal.innerText = chicken.toFixed(2);
  eggTotal.innerText = egg.toFixed(2);
  grandTotal.innerText = total.toFixed(2);
  balance.innerText = bal.toFixed(2);
  balance.style.color = bal >= 0 ? "green" : "red";
}

/* NEXT CUSTOMER */
nextCustomerBtn.onclick = () => {
  const bill = Number(grandTotal.innerText) || 0;
  if (bill > 0) {
    dailySales += bill;
    localStorage.setItem("dailySales", dailySales);
    dailyTotal.innerText = dailySales.toFixed(2);
  }
  kgInput.value = amountInput.value = eggQty.value = amountReceived.value = "";
};
</script>

</body>
</html>
