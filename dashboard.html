<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Today Dashboard</title>

<style>
body{margin:0;font-family:system-ui;background:#f1f5f9}
.header{background:#16a34a;color:#fff;padding:16px;font-size:26px;font-weight:900;text-align:center}
.container{max-width:1100px;margin:auto;padding:16px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}
.card{background:#fff;border-radius:16px;padding:18px;box-shadow:0 4px 10px rgba(0,0,0,.08)}
h4{margin:0;color:#64748b;font-size:14px}
.value{margin-top:6px;font-size:26px;font-weight:900}
</style>
</head>

<body>
<div class="header">ðŸ“Š Todayâ€™s Dashboard</div>

<div class="container">
<div class="grid">
  <div class="card"><h4>Total Sale</h4><div class="value">â‚¹ <span id="totalSale">0</span></div></div>
  <div class="card"><h4>Cash</h4><div class="value">â‚¹ <span id="cashSale">0</span></div></div>
  <div class="card"><h4>Online</h4><div class="value">â‚¹ <span id="onlineSale">0</span></div></div>
  <div class="card"><h4>Bills</h4><div class="value"><span id="billCount">0</span></div></div>

  <div class="card"><h4>Broiler Sold</h4><div class="value"><span id="broilerKg">0</span> kg</div></div>
  <div class="card"><h4>Country Sold</h4><div class="value"><span id="countryKg">0</span> kg</div></div>
  <div class="card"><h4>Eggs Sold</h4><div class="value"><span id="eggQty">0</span></div></div>
  <div class="card"><h4>Masala</h4><div class="value">â‚¹ <span id="masalaAmt">0</span></div></div>
</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getFirestore, collection, query, where, getDocs } 
from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyComVLxo36wvogoBFEoWyea-_yESW9BIPU",
  authDomain: "anus-chicken-shop.firebaseapp.com",
  projectId: "anus-chicken-shop",
  storageBucket: "anus-chicken-shop.firebasestorage.app",
  messagingSenderId: "919858203138",
  appId: "1:919858203138:web:0488b2c97155616b50751b"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const today = new Date().toISOString().slice(0,10);

async function loadDashboard(){
  const q = query(collection(db,"sales"), where("date","==",today));
  const snap = await getDocs(q);

  let total=0,cash=0,online=0,bills=0;
  let broiler=0,country=0,eggs=0,masala=0;

  snap.forEach(doc=>{
    const s = doc.data();
    if(s.status==="deleted") return;

    bills++;

    if(s.status!=="refunded"){
      total += s.total || 0;
      if(s.payment==="cash") cash += s.total || 0;
      if(s.payment==="online") online += s.total || 0;

      if(s.items?.broiler) broiler += s.items.broiler.qty || 0;
      if(s.items?.country) country += s.items.country.qty || 0;
      if(s.items?.eggs) eggs += s.items.eggs.qty || 0;
      if(s.items?.masala) masala += s.items.masala.amount || 0;
    }
  });

  totalSale.innerText = total.toFixed(2);
  cashSale.innerText = cash.toFixed(2);
  onlineSale.innerText = online.toFixed(2);
  billCount.innerText = bills;
  broilerKg.innerText = broiler.toFixed(3);
  countryKg.innerText = country.toFixed(3);
  eggQty.innerText = eggs;
  masalaAmt.innerText = masala.toFixed(2);
}

loadDashboard();
</script>
</body>
</html>